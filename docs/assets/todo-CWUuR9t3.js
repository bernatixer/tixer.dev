import"./shared-C_e6Mb5k.js";const B=[{id:"shopping",name:"Shopping",color:"#FF6B6B"},{id:"work",name:"Work",color:"#4ECDC4"},{id:"personal",name:"Personal",color:"#966FD6"},{id:"ideas",name:"Ideas",color:"#FFD166"},{id:"health",name:"Health",color:"#06D6A0"},{id:"finance",name:"Finance",color:"#118AB2"}];Object.fromEntries(B.map(e=>[e.id,e]));const P=[{id:"inbox",title:"Inbox",order:0},{id:"todo",title:"To Do",order:1},{id:"doing",title:"Doing",order:2},{id:"done",title:"Done",order:3}];Object.fromEntries(P.map(e=>[e.id,e]));const H=[{state:"fresh",minDays:0,maxDays:3},{state:"aging",minDays:4,maxDays:7},{state:"stale",minDays:8,maxDays:14},{state:"dusty",minDays:15,maxDays:null}];function r(e){const t=new Date;return t.setDate(t.getDate()-e),t.setHours(0,0,0,0),t}function g(e){const t=new Date;return t.setDate(t.getDate()+e),t.setHours(0,0,0,0),t}function O(){return[{id:"task-1",title:"Look into new project management tools",priority:"medium",columnId:"inbox",tags:["ideas"],dueDate:null,createdAt:r(6),recurrence:null,subtasks:[]},{id:"task-2",title:"Check out that restaurant recommendation",priority:"low",columnId:"inbox",tags:["personal"],dueDate:null,createdAt:r(10),recurrence:null,subtasks:[]},{id:"task-3",title:"Research weekend hiking trails",priority:"low",columnId:"inbox",tags:["personal"],dueDate:null,createdAt:r(16),recurrence:null,subtasks:[]},{id:"task-4",title:"Compare credit card options",priority:"medium",columnId:"inbox",tags:["finance"],dueDate:null,createdAt:r(23),recurrence:null,subtasks:[]},{id:"task-5",title:"Return Amazon package before deadline",priority:"urgent",columnId:"todo",tags:["shopping"],dueDate:g(0),createdAt:r(1),recurrence:null,subtasks:[]},{id:"task-6",title:"Review PR #247 - API refactoring",priority:"high",columnId:"todo",tags:["work"],dueDate:g(1),createdAt:r(1),recurrence:null,subtasks:[]},{id:"task-7",title:"Prepare slides for Monday standup",priority:"high",columnId:"todo",tags:["work"],dueDate:g(2),createdAt:r(2),recurrence:null,subtasks:[{id:"st-7-1",text:"Gather metrics from last week",completed:!0},{id:"st-7-2",text:"Draft key accomplishments",completed:!0},{id:"st-7-3",text:"Add blockers section",completed:!0}]},{id:"task-8",title:"Buy groceries for the week",priority:"medium",columnId:"todo",tags:["shopping"],dueDate:g(1),createdAt:r(7),recurrence:null,subtasks:[{id:"st-8-1",text:"Milk and eggs",completed:!0},{id:"st-8-2",text:"Bread",completed:!0},{id:"st-8-3",text:"Fresh vegetables",completed:!1},{id:"st-8-4",text:"Chicken breast",completed:!1},{id:"st-8-5",text:"Pasta and sauce",completed:!1},{id:"st-8-6",text:"Coffee beans",completed:!1}]},{id:"task-9",title:"Pay rent",priority:"medium",columnId:"todo",tags:["finance"],dueDate:g(3),createdAt:r(2),recurrence:"monthly",subtasks:[]},{id:"task-10",title:"Book dentist appointment",priority:"medium",columnId:"todo",tags:["health"],dueDate:r(8),createdAt:r(14),recurrence:null,subtasks:[]},{id:"task-11",title:"Write documentation for new API endpoints",priority:"high",columnId:"doing",tags:["work"],dueDate:null,createdAt:r(3),recurrence:null,subtasks:[{id:"st-11-1",text:"Document /users endpoints",completed:!0},{id:"st-11-2",text:"Document /auth endpoints",completed:!1},{id:"st-11-3",text:"Add request/response examples",completed:!1},{id:"st-11-4",text:"Update OpenAPI spec",completed:!1}]},{id:"task-12",title:"Plan weekend trip to the mountains",priority:"medium",columnId:"doing",tags:["personal"],dueDate:g(1),createdAt:r(4),recurrence:null,subtasks:[{id:"st-12-1",text:"Choose hiking trail",completed:!0},{id:"st-12-2",text:"Check weather forecast",completed:!0},{id:"st-12-3",text:"Book cabin",completed:!0},{id:"st-12-4",text:"Pack hiking gear",completed:!1},{id:"st-12-5",text:"Buy snacks for the trip",completed:!1}]},{id:"task-13",title:"Deploy v2.3.0 to production",priority:"high",columnId:"done",tags:["work"],dueDate:null,createdAt:r(5),recurrence:null,subtasks:[]},{id:"task-14",title:"Update team on Q4 roadmap",priority:"medium",columnId:"done",tags:["work"],dueDate:null,createdAt:r(7),recurrence:null,subtasks:[]},{id:"task-15",title:"Fix critical bug in auth flow",priority:"urgent",columnId:"done",tags:["work"],dueDate:null,createdAt:r(3),recurrence:null,subtasks:[]},{id:"task-16",title:"Order new running shoes",priority:"low",columnId:"done",tags:["shopping"],dueDate:null,createdAt:r(10),recurrence:null,subtasks:[]},{id:"task-17",title:"Schedule annual checkup",priority:"medium",columnId:"done",tags:["health"],dueDate:null,createdAt:r(14),recurrence:"yearly",subtasks:[]},{id:"task-18",title:"Cancel unused subscription",priority:"low",columnId:"done",tags:["finance"],dueDate:null,createdAt:r(20),recurrence:null,subtasks:[]}]}let o={tasks:[],activeFilter:null,focusMode:!1,compactMode:!1};const p=new Map;function D(e,t){return p.has(e)||p.set(e,new Set),p.get(e).add(t),()=>{var s;(s=p.get(e))==null||s.delete(t)}}function l(e){var t;(t=p.get(e))==null||t.forEach(s=>s())}function A(){return o.tasks}function C(e){return o.tasks.find(t=>t.id===e)}function N(){return o.activeFilter}function w(){return o.focusMode}function R(){return o.compactMode}function $(e){const t={...e,id:M(),createdAt:new Date};return o.tasks=[...o.tasks,t],l("tasksChanged"),t}function z(e,t){const s=o.tasks.findIndex(n=>n.id===e);if(s===-1)return;const a={...o.tasks[s],...t};return o.tasks=[...o.tasks.slice(0,s),a,...o.tasks.slice(s+1)],l("tasksChanged"),a}function Y({taskId:e,targetColumnId:t,targetIndex:s}){const a=C(e);if(!a)return;const n=a.columnId,i=o.tasks.filter(k=>k.id!==e),u=i.filter(k=>k.columnId===t),h=i.filter(k=>k.columnId!==t),F={...a,columnId:t};u.splice(s,0,F),o.tasks=[...h,...u],l("tasksChanged"),l("taskMoved"),t==="done"&&n!=="done"&&a.recurrence&&V(a)}function G(e,t){const s=C(e);if(!s)return;const a=s.subtasks.map(n=>n.id===t?{...n,completed:!n.completed}:n);z(e,{subtasks:a})}function U(e){o.activeFilter=o.activeFilter===e?null:e,l("filterChanged")}function j(){o.activeFilter=null,l("filterChanged")}function W(){o.focusMode=!o.focusMode,l("focusModeChanged")}function _(e){o.focusMode=e,l("focusModeChanged")}function Q(){o.compactMode=!o.compactMode,l("compactModeChanged")}function V(e){if(!e.recurrence||!e.dueDate)return;const t=new Date(e.dueDate);switch(e.recurrence){case"daily":t.setDate(t.getDate()+1);break;case"weekly":t.setDate(t.getDate()+7);break;case"monthly":t.setMonth(t.getMonth()+1);break;case"yearly":t.setFullYear(t.getFullYear()+1);break}$({title:e.title,priority:e.priority,columnId:"todo",tags:[...e.tags],dueDate:t,recurrence:e.recurrence,subtasks:e.subtasks.map(s=>({...s,id:M(),completed:!1}))})}function Z(e){if(e.columnId!=="inbox"&&e.columnId!=="todo")return"fresh";const t=new Date;t.setHours(0,0,0,0);const s=new Date(e.createdAt);s.setHours(0,0,0,0);const a=Math.floor((t.getTime()-s.getTime())/(1e3*60*60*24));for(const n of H)if(a>=n.minDays&&(n.maxDays===null||a<=n.maxDays))return n.state;return"fresh"}function J(e){const t=new Date;t.setHours(0,0,0,0);const s=new Date(e.createdAt);return s.setHours(0,0,0,0),Math.floor((t.getTime()-s.getTime())/(1e3*60*60*24))}function K(){o.tasks=O(),l("tasksChanged")}function M(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}let f=null;function X(){document.querySelectorAll(".task-card").forEach(e=>{ee(e)}),document.querySelectorAll(".column-tasks").forEach(e=>{te(e)})}function ee(e){e.setAttribute("draggable","true"),e.addEventListener("dragstart",se),e.addEventListener("dragend",ae)}function te(e){e.addEventListener("dragover",ne),e.addEventListener("dragenter",oe),e.addEventListener("dragleave",re),e.addEventListener("drop",ie)}function se(e){f=this,this.classList.add("dragging"),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.innerHTML))}function ae(){this.classList.remove("dragging"),document.querySelectorAll(".column-tasks").forEach(e=>{e.classList.remove("drag-over")}),document.querySelectorAll(".task-card").forEach(e=>{e.classList.remove("drag-over")}),f=null,b()}function ne(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const t=T(this,e.clientY);document.querySelectorAll(".task-card").forEach(s=>{s.classList.remove("drag-over")}),t&&t.classList.add("drag-over")}function oe(){this.classList.add("drag-over")}function re(e){this.contains(e.relatedTarget)||this.classList.remove("drag-over")}function ie(e){if(e.preventDefault(),this.classList.remove("drag-over"),!f)return;const t=f.dataset.taskId;if(!t)return;const s=this.closest(".todo-column"),a=s==null?void 0:s.dataset.column;if(!a)return;const n=T(this,e.clientY),i=this.querySelector(".add-task-inline"),u=Array.from(this.querySelectorAll(".task-card:not(.dragging)"));let h=u.length;n&&(h=u.indexOf(n)),n?this.insertBefore(f,n):i?this.insertBefore(f,i):this.appendChild(f),Y({taskId:t,targetColumnId:a,targetIndex:h})}function T(e,t){return Array.from(e.querySelectorAll(".task-card:not(.dragging)")).reduce((a,n)=>{const i=n.getBoundingClientRect(),u=t-i.top-i.height/2;return u<0&&u>a.offset?{offset:u,element:n}:a},{offset:Number.NEGATIVE_INFINITY,element:null}).element}function b(){document.querySelectorAll(".todo-column").forEach(e=>{const t=e.querySelectorAll(".task-card").length,s=e.querySelector(".column-count");s&&(s.textContent=String(t))})}let m=null,v=null,y=null;function ce(){m=document.getElementById("filter-indicator"),v=document.getElementById("filter-name"),y=document.getElementById("filter-clear"),y==null||y.addEventListener("click",()=>{j()}),D("filterChanged",E),E()}function de(e,t){e.stopPropagation(),U(t)}function le(){document.querySelectorAll(".task-tag").forEach(e=>{const t=e,s=t.dataset.tag;s&&t.addEventListener("click",a=>de(a,s))})}function E(){const e=N();e?(document.body.classList.add("filtering"),m==null||m.classList.add("visible"),v&&(v.textContent=ue(e)),document.querySelectorAll(".task-card").forEach(t=>{const s=t;(s.dataset.tags||"").includes(e)?s.classList.remove("filtered-out"):s.classList.add("filtered-out")})):(document.body.classList.remove("filtering"),m==null||m.classList.remove("visible"),document.querySelectorAll(".task-card").forEach(t=>{t.classList.remove("filtered-out")}))}function ue(e){return e.charAt(0).toUpperCase()+e.slice(1)}let c=null,d=null;function me(){c=document.getElementById("btn-focus"),d=document.getElementById("btn-compact"),c==null||c.addEventListener("click",()=>{W()}),d==null||d.addEventListener("click",()=>{Q()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&w()&&_(!1)}),D("focusModeChanged",L),D("compactModeChanged",x),L(),x()}function L(){w()?(document.body.classList.add("focus-mode"),c==null||c.classList.add("active")):(document.body.classList.remove("focus-mode"),c==null||c.classList.remove("active"))}function x(){R()?(document.body.classList.add("compact-mode"),d==null||d.classList.add("active")):(document.body.classList.remove("compact-mode"),d==null||d.classList.remove("active"))}function fe(){document.querySelectorAll(".task-card.has-subtasks").forEach(e=>{ge(e)}),document.querySelectorAll(".subtask-checkbox").forEach(e=>{ke(e)})}function ge(e){e.addEventListener("click",t=>{const s=t.target;s.classList.contains("subtask-checkbox")||s.classList.contains("task-tag")||s.closest(".task-tag")||e.classList.toggle("expanded")})}function ke(e){e.addEventListener("change",t=>{t.stopPropagation();const s=e.closest(".subtask-item"),a=e.closest(".task-card"),n=a==null?void 0:a.dataset.taskId,i=s==null?void 0:s.dataset.subtaskId;!n||!i||(e.checked?s.classList.add("completed"):s.classList.remove("completed"),G(n,i),q(a))})}function q(e){const t=e.querySelectorAll(".subtask-checkbox"),s=e.querySelectorAll(".subtask-checkbox:checked"),a=t.length,n=s.length,i=e.querySelector(".progress-chip");i&&(i.textContent=`${n}/${a}`,i.classList.remove("complete","empty"),n===a&&a>0?i.classList.add("complete"):n===0&&i.classList.add("empty"))}function pe(){document.querySelectorAll(".task-card.has-subtasks").forEach(e=>{q(e)})}function he(e,t){const s=Z(t),a=J(t);e.dataset.age=s;const n=e.querySelector(".age-badge");n&&a>3&&(n.textContent=`${a}d`)}function I(e){e.forEach(t=>{const s=document.querySelector(`[data-task-id="${t.id}"]`);s&&he(s,t)})}function S(){console.log("Todo app initializing..."),K(),X(),ce(),me(),fe(),le(),I(A()),pe(),b(),D("tasksChanged",()=>{b(),I(A())}),console.log("Todo app initialized!")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();
